28/05/25

The cmake of the main game with NOSERVER=0 failed a lot due to the new "tools" subdirectory, I had trouble with rust not being installed but after resolving that the find_pascal_cmake.in(I think it was from the pascaltest one) failed due to the "CMAKE_FILES_DIRECTORY" variable printing an empty value which produced two "//" in the overall path, which caused it to fail, 
I don't know why that happened but maybe you don't need that variable?

Because of these problems, I used the latest 1.0.2 release as source. I hope that's not an issue.

I built both packages in Arch with the new modified gameServer/CMakeLists.txt, both seems to be working fine. You probably don't need these files for the main game in the split of the server and they also seemed to build fine without them:
    CheckHaskellPackageExists.cmake  
    FindGHC.cmake  

I moved these files from the "cmake_modules" directory to a new "server_cmake_modules" directory inside  gameServer/  and both, the main game with NOSERVER=0 and the server part stand-alone built fine seperately and seems to be working normally.

This hopefully makes sure the main game can be built with the old function of packaging the server along normally or seperately if one wishes.

Commands used for building both of the pkgs:

  cmake \
    -Bbuild \
    -DCMAKE_BUILD_TYPE="Release" \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DDATA_INSTALL_DIR=/usr/share/hedgewars \
    -DNOSERVER=0 
  make -C build  

  cmake  \
    -Bhedgewars-server \
    -SgameServer \
    -DCMAKE_BUILD_TYPE="Release" \
    -DCMAKE_INSTALL_PREFIX=/usr 
  make -C hedgewars-server